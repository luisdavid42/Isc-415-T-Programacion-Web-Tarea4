<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="grid.css" media="screen" title="no title" charset="utf-8">
    <title></title>
  </head>
  <body>
    <div class="container">
    </div>

     <script>

    var containerDiv = document.body.getElementsByClassName("container")[0];
    var matrix = document.body.getElementsByClassName("cell");
    var tail = [];
    //keyboard input
    //document.body.setAttribute("onkeydown", "setActivewithKeyboard(event)");

    for(var i=0; i<100; i++)
    {
      var newRow = document.createElement("div");
      newRow.classList.add("cell");
      newRow.setAttribute("onclick", "Ejercicio2(this)");
      var newRowElement = document.createTextNode("");
      newRow.appendChild(newRowElement);
      containerDiv.appendChild(newRow);
    }

    createSnake(getRandom(0,9), getRandom(0,9));

    //crea y renderiza la cabeza de la culebra en la posición especificada
    function createSnake(x,y){
      width = 10;

      var headCell = new Object;
      headCell.x = x;
      headCell.y = y;
      

      headCell.pos= cellTranslate(x,y,width);//la posición en el arreglo unidimensional

      //alert("x: " + headCell.xy);
      matrix[headCell.pos].classList.add("active-head");
      createTail(headCell,1,3)
    }

    function createTail(head,dir,numCells){
      //alert("x: " + head.x + "\ny: " + head.y + "\npos: " + head.pos);
      //horizontal
      if(dir === -1){
        for(var i=0;i<numCells;i++)
        {
          newBlock=head.pos - (i+1);
          //revisando si la cola de la culebra pasa de lado
          if(head.x<i+1)
          {
            newBlock+=10;
          }
          //growTail(newBlock);  
          matrix[newBlock].classList.add("active");
        }
      }
      //vertical
      else if (dir === 1) {
        for(var i=0;i<numCells;i++)
        {
          newBlock=head.pos - ((i+1)*10);
          //revisando si la cola de la culebra pasa de lado
          if(head.y<i+1)
          {
            newBlock+=100;
          }
          //growTail(newBlock);  
          
          matrix[newBlock].classList.add("active");
        }
      }


      
    }

    // function growTail(block)
    // {
    //   if(!tail.includes(block))
    //       tail.push(block);
    // }


    // setInterval(function(){
    //       var newSnakeBody = [];

    //         for(var i = 0; i<allCells.length;i++) {
    //           allCells[i].classList.remove("active");
    //         }

    //         for(var i = 1; i<=snakeBody.length;i++) {
    //           allCells[snakeBody[snakeBody.length-i]+1].classList.add("active");
    //           newSnakeBody.push(snakeBody[snakeBody.length-i]+1);
    //         }
    //         snakeBody = newSnakeBody;
    //     }, 500)





    //traduce un par de posiciones x,y de un arreglo bidimensional, en una posición unidimensional
    function cellTranslate(x,y,width){
        return width * y + x;
      }

    //obtiene un número aleatorio entre el rango especificado(incluyente)
    function getRandom(min, max) { 
      min = Math.ceil(min);
      max = Math.floor(max);
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }



    



















    function setActivewithKeyboard(event)
    {
      var activeCells = document.body.getElementsByClassName("cell");
      var activeCellNumber = -1;
      for (var i = 0; i<activeCells.length; i++)
      {
        if(activeCells[i].classList.contains("active"))
        {
          activeCellNumber = i;
          
        }
      }
      const keyName = event.key;

		  //izquierda
		  if (keyName === 'a'){
		    if(activeCellNumber-1>=0) {activeCells[activeCellNumber].classList.remove("active"); activeCells[activeCellNumber-1].classList.add("active")};
		    return;
		  }

		  //abajo
		  if (keyName === 's') {
		    if(activeCellNumber+10<100) {activeCells[activeCellNumber].classList.remove("active"); activeCells[activeCellNumber+10].classList.add("active")};
		    return;
		  }

		  //derecha
		  if (keyName === 'd') {
		    if(activeCellNumber+1<100) {activeCells[activeCellNumber].classList.remove("active"); activeCells[activeCellNumber+1].classList.add("active")};
		    return;
		  }

		  //arriba
		  if (keyName === 'w') {
		    if(activeCellNumber-10>=0) {activeCells[activeCellNumber].classList.remove("active"); activeCells[activeCellNumber-10].classList.add("active")};
		    return;
		  }
		}
    

    </script>
  </body>
</html>